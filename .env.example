# --- Frontend / Next.js runtime ---
APP_ENV=local
NODE_ENV=development
NEXT_PUBLIC_SITE_URL=http://localhost:3000
NEXT_PUBLIC_BACKEND_URL=http://localhost:5000/api
NEXT_PUBLIC_ENVIRONMENT_LABEL=local
NEXT_PUBLIC_SUPABASE_URL=http://localhost:54321
NEXT_PUBLIC_SUPABASE_ANON_KEY=anon-key
NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY=
NEXT_PUBLIC_ONBOARDING_PUBLIC_TOKEN=
NEXT_PUBLIC_FEATURE_FLAGS={}
NEXT_PUBLIC_SOCKET_TRANSPORT=polling
NEXT_PUBLIC_SOCKET_PATH=
NEXT_PUBLIC_TELEMETRY_URL=
NEXT_PUBLIC_SENTRY_DSN=
NEXT_PUBLIC_OPENAI_BASE_URL=
NEXT_PUBLIC_ADMIN_SESSION_COOKIE=admin_session
NEXT_PUBLIC_ADMIN_API_TOKEN=
NEXT_PUBLIC_ONBOARDING_ALLOW_MOCK=1
NEXT_PUBLIC_WEB_PUSH_PUBLIC_KEY=

# === Public web configuration (safe for client bundles) ===
NEXT_PUBLIC_APP_ENV=development
NEXT_PUBLIC_SITE_URL=http://localhost:3000
NEXT_PUBLIC_BACKEND_URL=http://localhost:3000/api
NEXT_PUBLIC_ENVIRONMENT_LABEL=development

# ============================================================================
# === Supabase Configuration ===
# ============================================================================
# WARNING: The keys below contain both PUBLIC and SERVER-ONLY secrets.
# - NEXT_PUBLIC_* variables are embedded in the browser bundle (client-safe)
# - Variables WITHOUT NEXT_PUBLIC_ prefix are SERVER-ONLY and must NEVER
#   be exposed to the client or used in browser code.

# Client-safe keys (embedded in browser bundle)
NEXT_PUBLIC_SUPABASE_URL=https://<project-ref>.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=<public-anon-key>

# SERVER-ONLY SECRETS - NEVER use these in client code or prefix with NEXT_PUBLIC_
SUPABASE_SERVICE_ROLE_KEY=<service-role-key> # SERVER-ONLY: Full admin access
SITE_SUPABASE_URL=https://<project-ref>.supabase.co # SERVER-ONLY: Server-side URL
SITE_SUPABASE_SECRET_KEY=<service-role-key> # SERVER-ONLY: Server-side secret
SUPABASE_REQUEST_TIMEOUT_MS=4000
SUPABASE_BREAKER_FAILURE_THRESHOLD=4
SUPABASE_BREAKER_RESET_MS=30000

# ============================================================================
# === Onboarding & AI Configuration ===
# ============================================================================
# WARNING: Separate public vs server-only tokens carefully
# - NEXT_PUBLIC_* values can be exposed to browsers
# - Other keys must remain server-only

# Client-safe token
NEXT_PUBLIC_ONBOARDING_PUBLIC_TOKEN=<public-onboarding-token>

# SERVER-ONLY SECRETS - NEVER prefix with NEXT_PUBLIC_
ONBOARDING_API_TOKEN=<server-onboarding-token> # SERVER-ONLY: Onboarding service auth
OPENAI_API_KEY=<openai-api-key> # SERVER-ONLY: OpenAI API key
OPENAI_REQUEST_TIMEOUT_MS=8000
OPENAI_BREAKER_FAILURE_THRESHOLD=3
OPENAI_BREAKER_RESET_MS=60000

# Optional: override model or base URL
# NEXT_PUBLIC_OPENAI_BASE_URL=https://api.openai.com/v1
# AGENT_ID=gikundiro-onboarding
# NEXT_PUBLIC_ONBOARDING_ALLOW_MOCK=0
# ONBOARDING_ALLOW_MOCK=0

# ============================================================================
# === Telemetry & Observability ===
# ============================================================================
# Provide at least one of the Sentry DSNs
NEXT_PUBLIC_SENTRY_DSN=
SENTRY_DSN=
BACKEND_SENTRY_DSN=
BACKEND_SENTRY_DSN_PRODUCTION=
BACKEND_SENTRY_DSN_STAGING=
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0
SENTRY_REPLAYS_SESSION_SAMPLE_RATE=0.05
SENTRY_REPLAYS_ERROR_SAMPLE_RATE=1.0
NEXT_PUBLIC_TELEMETRY_URL=/api/telemetry/app-state

# Loki log shipping (server-only)
LOKI_URL=
LOKI_BASIC_AUTH=
LOKI_USERNAME=
LOKI_PASSWORD=
LOKI_TENANT_ID=
LOKI_BATCH_INTERVAL=5

# Prometheus metrics protection
METRICS_TOKEN=
METRICS_BASIC_AUTH_USER=
METRICS_BASIC_AUTH_PASSWORD=

# ============================================================================
# === Session / Auth Configuration ===
# ============================================================================
# NEXT_PUBLIC_ADMIN_SESSION_COOKIE=admin_session
# NEXT_PUBLIC_ADMIN_API_TOKEN=

# ============================================================================
# === Socket & Real-time Options ===
# ============================================================================
# NEXT_PUBLIC_SOCKET_TRANSPORT=polling
# NEXT_PUBLIC_SOCKET_PATH=

# ============================================================================
# === WhatsApp OTP Authentication ===
# ============================================================================
META_WABA_BASE_URL=https://graph.facebook.com/v21.0
META_WABA_PHONE_NUMBER_ID=
META_WABA_ACCESS_TOKEN=
OTP_TEMPLATE_NAME=
OTP_TEMPLATE_LANGUAGE=en
OTP_TTL_SEC=300
RATE_LIMIT_PER_PHONE_PER_HOUR=5
JWT_SECRET=change-me-with-32-char-secret

# --- Observability / Logging ---
SENTRY_DSN=
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_REPLAYS_SESSION_SAMPLE_RATE=0.1
SENTRY_REPLAYS_ERROR_SAMPLE_RATE=0.1
LOKI_URL=
LOKI_USERNAME=
LOKI_PASSWORD=
LOKI_TENANT_ID=
LOKI_BATCH_INTERVAL=5
LOG_LEVEL=info

# --- Backend (NestJS) ---
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/postgres
REDIS_URL=redis://localhost:6379/0
CORS_ORIGIN=http://localhost:3000
ADMIN_SESSION_SECRET=change-me-admin-session
FAN_SESSION_SECRET=change-me-fan-session
METRICS_TOKEN=metrics-token
S3_ENDPOINT=
S3_BUCKET=
S3_REGION=
S3_ACCESS_KEY_ID=
S3_SECRET_ACCESS_KEY=

# --- Tooling & scripts ---
PORT=3000
APP_BASE_URL=http://localhost:3000
PREFLIGHT_ALLOW_MISSING_ENV=0
E2E_API_MOCKS=1
CI=

# --- Mobile native configuration ---
API_BASE_URL=http://localhost:5000/api
SUPABASE_URL=http://localhost:54321
SUPABASE_SERVICE_KEY=

# --- Testing overrides ---
TEST_REDIS_URL=
